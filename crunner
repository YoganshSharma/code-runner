#!/bin/bash

## Colors !

red=`tput setaf 1`
green=`tput setaf 2`
yellow=`tput setaf 3`
blue=`tput setaf 4`
purple=`tput setaf 5`
cyan=`tput setaf 6`
white=`tput setaf 7`
black=`tput setaf 8`
orange=`tput setaf 9`
clean=$(tput sgr0)

## Help menu

USAGE="$(basename "$0"): ./crunner filename.extension -- compiles and executes the executable

NOTE: You must run this tool in the directory where the code file is.
"

while getopts f:h input
do
case "${input}"
in
h) echo "${USAGE}" && exit 0 ;;
*)  echo
	echo "Invalid option: -$input" && exit 0 ;;
esac
done

## Logic for runnig(compiling+executing) files

FILE=$1

if [[ "${FILE#*.}" == c ]]; then

    gcc -Wall -g $1 -o ${FILE%%.*}
    rm -rf ./${FILE%%.*}.dSYM
    ./${FILE%%.*}

elif [[ "${FILE#*.}" == cpp ]]; then

    g++ -Wall -g $1 -o ${FILE%%.*}
    rm -rf ./${FILE%%.*}.dSYM
    ./${FILE%%.*}

else 

    ERROR=$(echo "${white}Unsupported filetype specified.")

    echo "${red}ERROR:" $ERROR
    echo "${blue}Exitting crunner.."

fi
